# Конфигурация Grand Publicador

Приложение использует систему конфигурации на основе YAML-файла для управления основными параметрами.

## Обзор

Система конфигурации работает следующим образом:
1. В корне репозитория находится файл `app-config-default.yaml` — это эталонный файл с настройками по умолчанию.
2. При первом запуске сервера, если в папке `DATA_DIR` отсутствует файл `app-config.yaml`, он автоматически создается путем копирования `app-config-default.yaml`.
3. Приложение загружает настройки из `DATA_DIR/app-config.yaml`.
4. В файле конфигурации поддерживается подстановка переменных окружения.

## Формат файла app-config.yaml

Файл использует синтаксис YAML. Все ключи написаны в **PascalCase**.

Пример содержимого по умолчанию:

```yaml
# Telegram settings
TelegramAdminId: ${TELEGRAM_ADMIN_ID}
TelegramBotToken: ${TELEGRAM_BOT_TOKEN}

# Security and Auth
JwtSecret: ${JWT_SECRET}
```

### Подстановка переменных окружения

Вы можете использовать переменные окружения прямо в YAML файле:
- `${VAR_NAME}` — будет заменено на значение `process.env.VAR_NAME`.
- `${VAR_NAME:-default}` — будет заменено на значение переменной окружения, либо на `default`, если переменная не установлена.

## Управление через Admin UI

Администраторы системы могут просматривать и редактировать конфигурацию прямо из интерфейса приложения:
1. Перейдите в **Admin Panel** (Панель управления).
2. Откройте вкладку **Configuration** (Конфигурация).
3. Отредактируйте YAML и нажмите **Save**.

### Применение изменений (Hot Reload)

Изменения, внесенные через Admin UI, сохраняются в файл `DATA_DIR/app-config.yaml` и **применяются мгновенно** без необходимости перезагрузки сервера.

> [!CAUTION]
> Будьте осторожны при редактировании конфига. Некорректные значения могут привести к нестабильной работе модулей (например, неверный `TelegramBotToken` сломает авторизацию через Telegram).

## Приоритет настроек

1. Если параметр указан в `app-config.yaml` в виде конкретного значения (например, `JwtSecret: "my-super-secret"`), будет использовано именно оно.
2. Если в `app-config.yaml` используется переменная окружения (например, `${JWT_SECRET}`), значение будет взято из `.env` файла или окружения процесса.
3. Если файл `app-config.yaml` отсутствует, он будет создан из `app-config-default.yaml` при следующем запуске.
