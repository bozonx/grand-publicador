summary: ''
description: ''
value:
  modules:
    - id: a
      value:
        type: script
        input_transforms:
          auth:
            type: static
            value: '$res:u/ipkozyrin/antifem_news_bot'
          chat_id:
            type: javascript
            expr: flow_input.chatId
          inlineKbd:
            type: static
            value: []
          text:
            type: javascript
            expr: flow_input.request.message.text
        is_trigger: false
        path: f/common/telegram_send_text_msg
  chat_input_enabled: false
  preprocessor_module:
    id: preprocessor
    value:
      type: rawscript
      content: |
        /**
         * Trigger preprocessor
         *
         * It processes raw trigger data from various sources (webhook, custom HTTP route, SQS, WebSocket, Kafka, NATS, MQTT, Postgres, or email) 
         * before passing it to the flow. This separates the trigger logic from the flow logic and keeps the auto-generated UI clean.
         * 
         * The returned object determines the parameter values passed to the flow.
         * e.g., `{ b: 1, a: 2 }` â†’ Calls the flow with `a = 2` and `b = 1`, assuming the flow has two inputs called `a` and `b`.
         * Ensure that the input names of the flow match the keys in the returned object.
         * 
         * Learn more: https://www.windmill.dev/docs/core_concepts/preprocessors
         */
        export async function preprocessor(
          event:
            | {
                kind: "webhook";
                body: any,
                raw_string: string | null,
                query: Record<string, string>;
                headers: Record<string, string>;
              }
        ) {
          return {
            ...event.body,
            chatId: event.body.message.chat.id,
            request: event.body
          };
        }
      input_transforms:
        event:
          type: static
      language: bun
schema:
  $schema: 'https://json-schema.org/draft/2020-12/schema'
  type: object
  order:
    - chatId
    - request
  properties:
    chatId:
      type: number
      description: ''
    request:
      type: object
      additionalProperties: false
      order:
        - message
        - update_id
      properties:
        message:
          type: object
          additionalProperties: false
          order:
            - chat
            - date
            - from
            - text
            - message_id
          properties:
            chat:
              type: object
              additionalProperties: false
              order:
                - id
                - type
                - username
                - first_name
              properties:
                id:
                  type: integer
                type:
                  type: string
                first_name:
                  type: string
                username:
                  type: string
            date:
              type: integer
            from:
              type: object
              additionalProperties: false
              properties:
                id:
                  type: integer
                first_name:
                  type: string
                is_bot:
                  type: boolean
                language_code:
                  type: string
                username:
                  type: string
            message_id:
              type: integer
            text:
              type: string
        update_id:
          type: integer
  required: []
